(function(){$(function(){var n,t;n=$.connection.commentsHub;n.client.addComment=function(n,t,i,r,u){var o,f,e;return t!==""?(f=$(".game-comment[data-id="+t+"]").closest("li"),f.append($("<button type='button' class='hideable-toggle'><\/button>")),f.is(":has('ul')")||f.append($("<ul><\/ul>")),e=f.find("ul")):e=$(".comments-list > ul"),o=$("<li> <div class='game-comment' data-id="+n+"> <button class='delete-comment-button'>x<\/button> <h3 class='author-name'>"+i+"<\/h3> <div class='comment-body'>"+(r+u)+"<\/div> <div class='comment-buttons'> <a class='comment-button answer-to-comment' data-id='"+n+"'>Answer<\/a> <a class='comment-button quote-comment' data-id='"+n+"'>Quote<\/a> <\/div> <\/div> <\/li>"),e.append(o)};n.client.deleteComment=function(n){var i,t;return i=$(".game-comment[data-id="+n+"]").closest("li"),t=i.parent(),i.remove(),t.is(":empty")&&(t.prev(".hideable-toggle").remove(),!t.parent().is(".comments-list"))?t.remove():void 0};n.client.changeCommentBody=function(n,t){var i;return i=$(".game-comment[data-id="+n+"]"),i.find(".comment-body").text(t)};$.connection.hub.start().done(function(){n.server.joinGroup($("#GameId").val());window.onbeforeunload=function(){return n.server.leaveGroup($("#GameId").val()),window.close()};$("input[type='submit']").on("click",function(t){var i;return t.preventDefault(),i=$("textarea"),$("form").valid()?(n.server.createComment($("#GameId").val(),$("#CreateModel_ParentCommentId").val(),$("#CreateModel_Name").val(),$(".quotes").html(),i.val()),$("#CreateModel_ParentCommentId").val(""),$("#CreateModel_Name").val(""),$(".quotes").html(""),i.val(""),$(".answerin-to").removeClass("answerin-to"),$(".quotin").removeClass("quotin")):void 0});return $("#body-wrapper").on("click",".delete-comment-button",function(){var t,i;return t=$(this).closest(".game-comment").data("id"),i=new Modal({headerText:"Confirm",message:"Are you sure, you wanna delete this comment?"},{success:function(){return n.server.deleteComment($("#GameId").val(),t),$("#layout").removeClass("blured")},cancel:function(){return $("#layout").removeClass("blured")}}),$("#layout").addClass("blured"),i.open()})});$("#body-wrapper").on("click",".answer-to-comment",function(){var n;return n=$(this),n.hasClass("answerin-to")?($("#CreateModel_ParentCommentId").val(""),n.removeClass("answerin-to")):($(".answerin-to").removeClass("answerin-to"),$("#CreateModel_ParentCommentId").val(n.data("id")),$("#CreateModel_Body").val(n.closest(".game-comment").find(".author-name").text()+", "+$("#CreateModel_Body").val()),n.addClass("answerin-to")),changeFormClass($("#CreateModel_Body"))});t=null;$("#body-wrapper").on("mousedown",function(){var n;return n=window.getSelection().rangeCount===1,n?t=window.getSelection().getRangeAt(0):void 0});return $("#body-wrapper").on("click",".quote-comment",function(n){var r,u,i,f,e;return n.preventDefault(),i=$(this),i.hasClass("quotin")?($("quote[data-id='"+i.data("id")+"']").remove(),i.removeClass("quotin")):(u=i.closest(".game-comment"),r=u.find(".comment-body"),e=t&&t.toString()!==""&&t.intersectsNode(r[0])&&t.startContainer===t.endContainer?t.toString():r.html(),f=u.find(".author-name").text(),$(".quotes").append("<quote data-id='"+i.data("id")+"'> <h4 class='quote-author-name'> <b>"+f+"<\/b> wrote<\/h4><div class='quote-body'>"+e+"<\/div><\/quote>"),i.addClass("quotin"))})})}).call(this);
//# sourceMappingURL=comments.min.js.map
