@using GameStore.Web.Models
@model IEnumerable<GenreViewModel>

@{
    Func<IEnumerable<GenreViewModel>, MvcHtmlString> getGenresList = null;
    getGenresList = (genres) =>
    {
        var ulTag = new TagBuilder("ul");
        foreach (var genre in genres)
        {
            var liTag = new TagBuilder("li");
            
            var genreCheckBox = new TagBuilder("input");
            genreCheckBox.Attributes["type"] = "checkbox";
            genreCheckBox.Attributes["value"] = genre.Id.ToString();
            genreCheckBox.Attributes["id"] = "genre" + genre.Id.ToString();
            genreCheckBox.Attributes["name"] = "CreateModel.GenreIds";
            
            var labelFor = new TagBuilder("label");
            labelFor.Attributes["for"] = "genre" + genre.Id.ToString();
            labelFor.SetInnerText(genre.Name);
            
            liTag.InnerHtml += genreCheckBox;
            liTag.InnerHtml += labelFor;
            if (genre.ChildGenres != null && genre.ChildGenres.Any())
            {
                liTag.InnerHtml += getGenresList(genre.ChildGenres);
            }
            
            ulTag.InnerHtml += liTag;
        }
        return new MvcHtmlString(ulTag.ToString());
    };
}

@getGenresList(Model)